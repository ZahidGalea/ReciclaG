{% extends 'app/base.html' %} {% load static %} {% block contenido %}

    <div id="wrap">
        <div id="main" class="container clear-top">

            <div class="container contacto">
                <form class="container">
                    <div class="row justify-content-md-center">
                        <div class="col">
                            <h1 class="align-content-center">¡Inscríbete para registrar tus iniciativas!</h1>
                        </div>

                    </div>
                    <div class="mb-3">
                        <label for="organizacion" class="form-label">Organización</label>
                        <input type="text" class="form-control" id="organizacion">
                    </div>
                    <div class="alert alert-danger" role="alert" id="msgErrorOrganizacion">
                        <label class="form-label" id="txtErrorOrganizacion">Debe ingresar el nombre de la
                            organización</label>
                    </div>

                    <div class="mb-3">
                        <label for="telefono" class="form-label">Teléfono</label>
                        <input type="text" class="form-control" id="telefono">Formato 123456789</input>
                    </div>
                    <div class="alert alert-warning" role="alert" id="msgErrorDigitos">
                        <label class="form-label" id="txtErrorDigitos">El número debe tener 9 dígitos</label>
                    </div>
                    <div class="alert alert-warning" role="alert" id="msgErrorTexto">
                        <label class="form-label" id="txtErrorTexto">Sólo puede ingresar números</label>
                    </div>


                    <div class="alert alert-danger" role="alert" id="msgErrorFono">
                        <label class="form-label" id="txtErrorFono">Debe ingresar un número de contacto</label>
                    </div>

                    <div class="mb-3">
                        <label for="email" class="form-label">Correo electrónico</label>
                        <input type="email" class="form-control" id="email" aria-describedby="emailHelp">
                    </div>
                    <div class="alert alert-danger" role="alert" id="emailValidation">
                        <h6>El correo ingresado no es válido.</h6>
                    </div>
                    <div class="alert alert-danger" role="alert" id="msgErrorMail">
                        <label class="form-label" id="txtErrorMail">Debe ingresar un correo electrónico</label>
                    </div>

                    <div class="mb-3">
                        <label for="password" class="form-label">Clave</label>
                        <input type="password" class="form-control" id="password" aria-describedby="emailHelp">
                    </div>
                    <!-- validación requerimientos clave -->
                    <div class="alert alert-light" role="alert" id="password-require">
                        <h6>Requerimientos de la contraseña:</h6>
                        <ul>
                            <li id="letter" class="invalid">Al menos <strong>una minúscula</strong></li>
                            <li id="capital" class="invalid">Al menos <strong>una mayúscula</strong></li>
                            <li id="number" class="invalid">Al menos <strong>un número</strong></li>
                            <li id="length" class="invalid">Al menos <strong>8 carácteres</strong></li>
                            <!-- <li id="character" class="invalid">Al menos <strong>un carácter especial</strong></li> -->
                        </ul>
                    </div>
                    <div class="alert alert-danger" role="alert" id="msgErrorClave">
                        <label class="form-label" id="txtErrorClave">Debe ingresar una clave</label>
                    </div>

                    <div class="row align-content-end">
                        <div class="col offset-lg-10 offset-md-9 offset-sm-8 offset-xl-10">
                            <div class="btnGeneral">
                                <!-- <a href="#" id="registrar">¡Inscribirme!</a> -->
                                <button type="button" class="btn btnGeneral" id="registrar"
                                        data-target="#validationModal">
                                    Inscribirme
                                </button>
                            </div>

                        </div>

                    </div>


                </form>

            </div>

        </div>
    </div>

    <!-- Modal-->
    <div class="modal" id="validationModal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Notificación</h4>
                    <button type="button" class="close" data-dismiss="modal">×</button>

                </div>
                <div class="modal-body">
                    <!-- <div class="alert alert-success" role="alert" id="#msgSuccessModal"> -->
                    <label class="form-label" id="textModalSuccess"></label>
                    <!-- </div> -->
                    <!-- <div class="alert alert-danger" role="alert" id="#msgErrorModal"> -->
                    <label class="form-label" id="textModalError"></label>
                    <!-- </div> -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- End Modal -->

    <!--
    Scripts section
    -->

    <!--
    Ends Scripts section
    -->

{% endblock %}

{% block page_scripts %}
    <script type="text/javascript">
        $(document).ready(function () {
            //apaga etiquetas alert
            $("#msgErrorOrganizacion").hide();
            $("#msgErrorFono").hide();
            $("#msgErrorDigitos").hide();
            $("#msgErrorTexto").hide();
            $("#msgErrorMail").hide();
            $("#msgErrorClave").hide();

            // funcion para validar la edad del usuario este en el rango 0 a 140
            $("#telefono").blur(function (event) {
                var fono = parseInt($("#telefono").val());
                if (fono < 111111111 || fono > 999999999) {
                    $("#msgErrorDigitos").show();
                    return false;
                } else {
                    $("#msgErrorDigitos").hide();
                }

            });

            $("#telefono").keypress(function (e) {
                //if the letter is not digit then display error and don't type anything
                if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                    //display error message
                    $("#msgErrorTexto").show();
                    return false;
                } else {
                    $("#msgErrorTexto").hide();
                }
            });


            //validando formato de correo
            $("#emailValidation").hide();
            $('#email').focus(function () {

                var emailInput = $('#email').val();
                var regExpEmail = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
                if (!regExpEmail.test(emailInput)) {
                    $("#emailValidation").show();
                } else {
                    $("#emailValidation").hide();
                }
            });

            //validando requerimientos clave
            $('#password-require').hide();
            $('#password').keyup(function () {
                // keyup code here
                var passwd = $(this).val();
                //letter
                if (passwd.match(/[A-z]/)) {
                    $('#letter').removeClass('invalid').addClass('valid');
                } else {
                    $('#letter').removeClass('valid').addClass('invalid');
                }
                //capital letter
                if (passwd.match(/[A-Z]/)) {
                    $('#capital').removeClass('invalid').addClass('valid');
                } else {
                    $('#capital').removeClass('valid').addClass('invalid');
                }
                //number
                if (passwd.match(/\d/)) {
                    $('#number').removeClass('invalid').addClass('valid');
                } else {
                    $('#number').removeClass('valid').addClass('invalid');
                }
                //length
                if (passwd.length < 8) {
                    $('#length').removeClass('valid').addClass('invalid');
                } else {
                    $('#length').removeClass('invalid').addClass('valid');
                }
                //special characters
                // if (passwd.match(/^\s*[~!@#$%^&*\s]+\s*$/)){
                //   $('#character').removeClass('valid').addClass('invalid');
                // } else {
                //   $('#character').removeClass('invalid').addClass('valid');
                // }


            }).focus(function () {
                $('#password-require').show();
            }).blur(function () {
                $('#password-require').hide();
            });


            //valida envio de formulario
            $("#registrar").click(function () {

                var retorno = true;
                var organizacion = $("#organizacion").val();
                var fono = $("#telefono").val();
                var email = $("#email").val();
                var password = $("#password").val();

                if (organizacion.trim() <= 0) {
                    $("#msgErrorOrganizacion").show();
                    $("#validationModal").modal('show');
                    $("#textModalError").text("Hay errores en el formulario.");
                    $("#textModalSuccess").hide();
                    retorno = false;
                } else {
                    $("#msgErrorOrganizacion").hide();


                }

                if (fono.trim() <= 0) {
                    $("#msgErrorFono").show();
                    $("#validationModal").modal('show');
                    $("#textModalError").text("Hay errores en el formulario.");
                    $("#textModalSuccess").hide();
                    retorno = false;
                } else {
                    $("#msgErrorFono").hide();
                }

                if (email.trim() <= 0) {
                    $("#msgErrorMail").show();
                    $("#validationModal").modal('show');
                    $("#textModalError").text("Hay errores en el formulario.");
                    $("#textModalSuccess").hide();
                    retorno = false;
                } else {

                    $("#msgErrorMail").hide();
                }


                return retorno


            });


        });
    </script>
{% endblock %}